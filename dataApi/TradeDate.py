# 函数完成
import datetime as dt
import numpy as np
import pandas as pd
from BasicData.local_path import *

trade_ticks = [
92500, 93003, 93006, 93009, 93012, 93015, 93018, 93021, 93024, 93027, 93030, 93033, 93036, 93039, 93042,
93045, 93048, 93051, 93054, 93057, 93100, 93103, 93106, 93109, 93112, 93115, 93118, 93121, 93124, 93127,
93130, 93133, 93136, 93139, 93142, 93145, 93148, 93151, 93154, 93157, 93200, 93203, 93206, 93209, 93212,
93215, 93218, 93221, 93224, 93227, 93230, 93233, 93236, 93239, 93242, 93245, 93248, 93251, 93254, 93257,
93300, 93303, 93306, 93309, 93312, 93315, 93318, 93321, 93324, 93327, 93330, 93333, 93336, 93339, 93342,
93345, 93348, 93351, 93354, 93357, 93400, 93403, 93406, 93409, 93412, 93415, 93418, 93421, 93424, 93427,
93430, 93433, 93436, 93439, 93442, 93445, 93448, 93451, 93454, 93457, 93500, 93503, 93506, 93509, 93512,
93515, 93518, 93521, 93524, 93527, 93530, 93533, 93536, 93539, 93542, 93545, 93548, 93551, 93554, 93557,
93600, 93603, 93606, 93609, 93612, 93615, 93618, 93621, 93624, 93627, 93630, 93633, 93636, 93639, 93642,
93645, 93648, 93651, 93654, 93657, 93700, 93703, 93706, 93709, 93712, 93715, 93718, 93721, 93724, 93727,
93730, 93733, 93736, 93739, 93742, 93745, 93748, 93751, 93754, 93757, 93800, 93803, 93806, 93809, 93812,
93815, 93818, 93821, 93824, 93827, 93830, 93833, 93836, 93839, 93842, 93845, 93848, 93851, 93854, 93857,
93900, 93903, 93906, 93909, 93912, 93915, 93918, 93921, 93924, 93927, 93930, 93933, 93936, 93939, 93942,
93945, 93948, 93951, 93954, 93957, 94000, 94003, 94006, 94009, 94012, 94015, 94018, 94021, 94024, 94027,
94030, 94033, 94036, 94039, 94042, 94045, 94048, 94051, 94054, 94057, 94100, 94103, 94106, 94109, 94112,
94115, 94118, 94121, 94124, 94127, 94130, 94133, 94136, 94139, 94142, 94145, 94148, 94151, 94154, 94157,
94200, 94203, 94206, 94209, 94212, 94215, 94218, 94221, 94224, 94227, 94230, 94233, 94236, 94239, 94242,
94245, 94248, 94251, 94254, 94257, 94300, 94303, 94306, 94309, 94312, 94315, 94318, 94321, 94324, 94327,
94330, 94333, 94336, 94339, 94342, 94345, 94348, 94351, 94354, 94357, 94400, 94403, 94406, 94409, 94412,
94415, 94418, 94421, 94424, 94427, 94430, 94433, 94436, 94439, 94442, 94445, 94448, 94451, 94454, 94457,
94500, 94503, 94506, 94509, 94512, 94515, 94518, 94521, 94524, 94527, 94530, 94533, 94536, 94539, 94542,
94545, 94548, 94551, 94554, 94557, 94600, 94603, 94606, 94609, 94612, 94615, 94618, 94621, 94624, 94627,
94630, 94633, 94636, 94639, 94642, 94645, 94648, 94651, 94654, 94657, 94700, 94703, 94706, 94709, 94712,
94715, 94718, 94721, 94724, 94727, 94730, 94733, 94736, 94739, 94742, 94745, 94748, 94751, 94754, 94757,
94800, 94803, 94806, 94809, 94812, 94815, 94818, 94821, 94824, 94827, 94830, 94833, 94836, 94839, 94842,
94845, 94848, 94851, 94854, 94857, 94900, 94903, 94906, 94909, 94912, 94915, 94918, 94921, 94924, 94927,
94930, 94933, 94936, 94939, 94942, 94945, 94948, 94951, 94954, 94957, 95000, 95003, 95006, 95009, 95012,
95015, 95018, 95021, 95024, 95027, 95030, 95033, 95036, 95039, 95042, 95045, 95048, 95051, 95054, 95057,
95100, 95103, 95106, 95109, 95112, 95115, 95118, 95121, 95124, 95127, 95130, 95133, 95136, 95139, 95142,
95145, 95148, 95151, 95154, 95157, 95200, 95203, 95206, 95209, 95212, 95215, 95218, 95221, 95224, 95227,
95230, 95233, 95236, 95239, 95242, 95245, 95248, 95251, 95254, 95257, 95300, 95303, 95306, 95309, 95312,
95315, 95318, 95321, 95324, 95327, 95330, 95333, 95336, 95339, 95342, 95345, 95348, 95351, 95354, 95357,
95400, 95403, 95406, 95409, 95412, 95415, 95418, 95421, 95424, 95427, 95430, 95433, 95436, 95439, 95442,
95445, 95448, 95451, 95454, 95457, 95500, 95503, 95506, 95509, 95512, 95515, 95518, 95521, 95524, 95527,
95530, 95533, 95536, 95539, 95542, 95545, 95548, 95551, 95554, 95557, 95600, 95603, 95606, 95609, 95612,
95615, 95618, 95621, 95624, 95627, 95630, 95633, 95636, 95639, 95642, 95645, 95648, 95651, 95654, 95657,
95700, 95703, 95706, 95709, 95712, 95715, 95718, 95721, 95724, 95727, 95730, 95733, 95736, 95739, 95742,
95745, 95748, 95751, 95754, 95757, 95800, 95803, 95806, 95809, 95812, 95815, 95818, 95821, 95824, 95827,
95830, 95833, 95836, 95839, 95842, 95845, 95848, 95851, 95854, 95857, 95900, 95903, 95906, 95909, 95912,
95915, 95918, 95921, 95924, 95927, 95930, 95933, 95936, 95939, 95942, 95945, 95948, 95951, 95954, 95957,
100000, 100003, 100006, 100009, 100012, 100015, 100018, 100021, 100024, 100027, 100030, 100033, 100036, 100039, 100042,
100045, 100048, 100051, 100054, 100057, 100100, 100103, 100106, 100109, 100112, 100115, 100118, 100121, 100124, 100127,
100130, 100133, 100136, 100139, 100142, 100145, 100148, 100151, 100154, 100157, 100200, 100203, 100206, 100209, 100212,
100215, 100218, 100221, 100224, 100227, 100230, 100233, 100236, 100239, 100242, 100245, 100248, 100251, 100254, 100257,
100300, 100303, 100306, 100309, 100312, 100315, 100318, 100321, 100324, 100327, 100330, 100333, 100336, 100339, 100342,
100345, 100348, 100351, 100354, 100357, 100400, 100403, 100406, 100409, 100412, 100415, 100418, 100421, 100424, 100427,
100430, 100433, 100436, 100439, 100442, 100445, 100448, 100451, 100454, 100457, 100500, 100503, 100506, 100509, 100512,
100515, 100518, 100521, 100524, 100527, 100530, 100533, 100536, 100539, 100542, 100545, 100548, 100551, 100554, 100557,
100600, 100603, 100606, 100609, 100612, 100615, 100618, 100621, 100624, 100627, 100630, 100633, 100636, 100639, 100642,
100645, 100648, 100651, 100654, 100657, 100700, 100703, 100706, 100709, 100712, 100715, 100718, 100721, 100724, 100727,
100730, 100733, 100736, 100739, 100742, 100745, 100748, 100751, 100754, 100757, 100800, 100803, 100806, 100809, 100812,
100815, 100818, 100821, 100824, 100827, 100830, 100833, 100836, 100839, 100842, 100845, 100848, 100851, 100854, 100857,
100900, 100903, 100906, 100909, 100912, 100915, 100918, 100921, 100924, 100927, 100930, 100933, 100936, 100939, 100942,
100945, 100948, 100951, 100954, 100957, 101000, 101003, 101006, 101009, 101012, 101015, 101018, 101021, 101024, 101027,
101030, 101033, 101036, 101039, 101042, 101045, 101048, 101051, 101054, 101057, 101100, 101103, 101106, 101109, 101112,
101115, 101118, 101121, 101124, 101127, 101130, 101133, 101136, 101139, 101142, 101145, 101148, 101151, 101154, 101157,
101200, 101203, 101206, 101209, 101212, 101215, 101218, 101221, 101224, 101227, 101230, 101233, 101236, 101239, 101242,
101245, 101248, 101251, 101254, 101257, 101300, 101303, 101306, 101309, 101312, 101315, 101318, 101321, 101324, 101327,
101330, 101333, 101336, 101339, 101342, 101345, 101348, 101351, 101354, 101357, 101400, 101403, 101406, 101409, 101412,
101415, 101418, 101421, 101424, 101427, 101430, 101433, 101436, 101439, 101442, 101445, 101448, 101451, 101454, 101457,
101500, 101503, 101506, 101509, 101512, 101515, 101518, 101521, 101524, 101527, 101530, 101533, 101536, 101539, 101542,
101545, 101548, 101551, 101554, 101557, 101600, 101603, 101606, 101609, 101612, 101615, 101618, 101621, 101624, 101627,
101630, 101633, 101636, 101639, 101642, 101645, 101648, 101651, 101654, 101657, 101700, 101703, 101706, 101709, 101712,
101715, 101718, 101721, 101724, 101727, 101730, 101733, 101736, 101739, 101742, 101745, 101748, 101751, 101754, 101757,
101800, 101803, 101806, 101809, 101812, 101815, 101818, 101821, 101824, 101827, 101830, 101833, 101836, 101839, 101842,
101845, 101848, 101851, 101854, 101857, 101900, 101903, 101906, 101909, 101912, 101915, 101918, 101921, 101924, 101927,
101930, 101933, 101936, 101939, 101942, 101945, 101948, 101951, 101954, 101957, 102000, 102003, 102006, 102009, 102012,
102015, 102018, 102021, 102024, 102027, 102030, 102033, 102036, 102039, 102042, 102045, 102048, 102051, 102054, 102057,
102100, 102103, 102106, 102109, 102112, 102115, 102118, 102121, 102124, 102127, 102130, 102133, 102136, 102139, 102142,
102145, 102148, 102151, 102154, 102157, 102200, 102203, 102206, 102209, 102212, 102215, 102218, 102221, 102224, 102227,
102230, 102233, 102236, 102239, 102242, 102245, 102248, 102251, 102254, 102257, 102300, 102303, 102306, 102309, 102312,
102315, 102318, 102321, 102324, 102327, 102330, 102333, 102336, 102339, 102342, 102345, 102348, 102351, 102354, 102357,
102400, 102403, 102406, 102409, 102412, 102415, 102418, 102421, 102424, 102427, 102430, 102433, 102436, 102439, 102442,
102445, 102448, 102451, 102454, 102457, 102500, 102503, 102506, 102509, 102512, 102515, 102518, 102521, 102524, 102527,
102530, 102533, 102536, 102539, 102542, 102545, 102548, 102551, 102554, 102557, 102600, 102603, 102606, 102609, 102612,
102615, 102618, 102621, 102624, 102627, 102630, 102633, 102636, 102639, 102642, 102645, 102648, 102651, 102654, 102657,
102700, 102703, 102706, 102709, 102712, 102715, 102718, 102721, 102724, 102727, 102730, 102733, 102736, 102739, 102742,
102745, 102748, 102751, 102754, 102757, 102800, 102803, 102806, 102809, 102812, 102815, 102818, 102821, 102824, 102827,
102830, 102833, 102836, 102839, 102842, 102845, 102848, 102851, 102854, 102857, 102900, 102903, 102906, 102909, 102912,
102915, 102918, 102921, 102924, 102927, 102930, 102933, 102936, 102939, 102942, 102945, 102948, 102951, 102954, 102957,
103000, 103003, 103006, 103009, 103012, 103015, 103018, 103021, 103024, 103027, 103030, 103033, 103036, 103039, 103042,
103045, 103048, 103051, 103054, 103057, 103100, 103103, 103106, 103109, 103112, 103115, 103118, 103121, 103124, 103127,
103130, 103133, 103136, 103139, 103142, 103145, 103148, 103151, 103154, 103157, 103200, 103203, 103206, 103209, 103212,
103215, 103218, 103221, 103224, 103227, 103230, 103233, 103236, 103239, 103242, 103245, 103248, 103251, 103254, 103257,
103300, 103303, 103306, 103309, 103312, 103315, 103318, 103321, 103324, 103327, 103330, 103333, 103336, 103339, 103342,
103345, 103348, 103351, 103354, 103357, 103400, 103403, 103406, 103409, 103412, 103415, 103418, 103421, 103424, 103427,
103430, 103433, 103436, 103439, 103442, 103445, 103448, 103451, 103454, 103457, 103500, 103503, 103506, 103509, 103512,
103515, 103518, 103521, 103524, 103527, 103530, 103533, 103536, 103539, 103542, 103545, 103548, 103551, 103554, 103557,
103600, 103603, 103606, 103609, 103612, 103615, 103618, 103621, 103624, 103627, 103630, 103633, 103636, 103639, 103642,
103645, 103648, 103651, 103654, 103657, 103700, 103703, 103706, 103709, 103712, 103715, 103718, 103721, 103724, 103727,
103730, 103733, 103736, 103739, 103742, 103745, 103748, 103751, 103754, 103757, 103800, 103803, 103806, 103809, 103812,
103815, 103818, 103821, 103824, 103827, 103830, 103833, 103836, 103839, 103842, 103845, 103848, 103851, 103854, 103857,
103900, 103903, 103906, 103909, 103912, 103915, 103918, 103921, 103924, 103927, 103930, 103933, 103936, 103939, 103942,
103945, 103948, 103951, 103954, 103957, 104000, 104003, 104006, 104009, 104012, 104015, 104018, 104021, 104024, 104027,
104030, 104033, 104036, 104039, 104042, 104045, 104048, 104051, 104054, 104057, 104100, 104103, 104106, 104109, 104112,
104115, 104118, 104121, 104124, 104127, 104130, 104133, 104136, 104139, 104142, 104145, 104148, 104151, 104154, 104157,
104200, 104203, 104206, 104209, 104212, 104215, 104218, 104221, 104224, 104227, 104230, 104233, 104236, 104239, 104242,
104245, 104248, 104251, 104254, 104257, 104300, 104303, 104306, 104309, 104312, 104315, 104318, 104321, 104324, 104327,
104330, 104333, 104336, 104339, 104342, 104345, 104348, 104351, 104354, 104357, 104400, 104403, 104406, 104409, 104412,
104415, 104418, 104421, 104424, 104427, 104430, 104433, 104436, 104439, 104442, 104445, 104448, 104451, 104454, 104457,
104500, 104503, 104506, 104509, 104512, 104515, 104518, 104521, 104524, 104527, 104530, 104533, 104536, 104539, 104542,
104545, 104548, 104551, 104554, 104557, 104600, 104603, 104606, 104609, 104612, 104615, 104618, 104621, 104624, 104627,
104630, 104633, 104636, 104639, 104642, 104645, 104648, 104651, 104654, 104657, 104700, 104703, 104706, 104709, 104712,
104715, 104718, 104721, 104724, 104727, 104730, 104733, 104736, 104739, 104742, 104745, 104748, 104751, 104754, 104757,
104800, 104803, 104806, 104809, 104812, 104815, 104818, 104821, 104824, 104827, 104830, 104833, 104836, 104839, 104842,
104845, 104848, 104851, 104854, 104857, 104900, 104903, 104906, 104909, 104912, 104915, 104918, 104921, 104924, 104927,
104930, 104933, 104936, 104939, 104942, 104945, 104948, 104951, 104954, 104957, 105000, 105003, 105006, 105009, 105012,
105015, 105018, 105021, 105024, 105027, 105030, 105033, 105036, 105039, 105042, 105045, 105048, 105051, 105054, 105057,
105100, 105103, 105106, 105109, 105112, 105115, 105118, 105121, 105124, 105127, 105130, 105133, 105136, 105139, 105142,
105145, 105148, 105151, 105154, 105157, 105200, 105203, 105206, 105209, 105212, 105215, 105218, 105221, 105224, 105227,
105230, 105233, 105236, 105239, 105242, 105245, 105248, 105251, 105254, 105257, 105300, 105303, 105306, 105309, 105312,
105315, 105318, 105321, 105324, 105327, 105330, 105333, 105336, 105339, 105342, 105345, 105348, 105351, 105354, 105357,
105400, 105403, 105406, 105409, 105412, 105415, 105418, 105421, 105424, 105427, 105430, 105433, 105436, 105439, 105442,
105445, 105448, 105451, 105454, 105457, 105500, 105503, 105506, 105509, 105512, 105515, 105518, 105521, 105524, 105527,
105530, 105533, 105536, 105539, 105542, 105545, 105548, 105551, 105554, 105557, 105600, 105603, 105606, 105609, 105612,
105615, 105618, 105621, 105624, 105627, 105630, 105633, 105636, 105639, 105642, 105645, 105648, 105651, 105654, 105657,
105700, 105703, 105706, 105709, 105712, 105715, 105718, 105721, 105724, 105727, 105730, 105733, 105736, 105739, 105742,
105745, 105748, 105751, 105754, 105757, 105800, 105803, 105806, 105809, 105812, 105815, 105818, 105821, 105824, 105827,
105830, 105833, 105836, 105839, 105842, 105845, 105848, 105851, 105854, 105857, 105900, 105903, 105906, 105909, 105912,
105915, 105918, 105921, 105924, 105927, 105930, 105933, 105936, 105939, 105942, 105945, 105948, 105951, 105954, 105957,
110000, 110003, 110006, 110009, 110012, 110015, 110018, 110021, 110024, 110027, 110030, 110033, 110036, 110039, 110042,
110045, 110048, 110051, 110054, 110057, 110100, 110103, 110106, 110109, 110112, 110115, 110118, 110121, 110124, 110127,
110130, 110133, 110136, 110139, 110142, 110145, 110148, 110151, 110154, 110157, 110200, 110203, 110206, 110209, 110212,
110215, 110218, 110221, 110224, 110227, 110230, 110233, 110236, 110239, 110242, 110245, 110248, 110251, 110254, 110257,
110300, 110303, 110306, 110309, 110312, 110315, 110318, 110321, 110324, 110327, 110330, 110333, 110336, 110339, 110342,
110345, 110348, 110351, 110354, 110357, 110400, 110403, 110406, 110409, 110412, 110415, 110418, 110421, 110424, 110427,
110430, 110433, 110436, 110439, 110442, 110445, 110448, 110451, 110454, 110457, 110500, 110503, 110506, 110509, 110512,
110515, 110518, 110521, 110524, 110527, 110530, 110533, 110536, 110539, 110542, 110545, 110548, 110551, 110554, 110557,
110600, 110603, 110606, 110609, 110612, 110615, 110618, 110621, 110624, 110627, 110630, 110633, 110636, 110639, 110642,
110645, 110648, 110651, 110654, 110657, 110700, 110703, 110706, 110709, 110712, 110715, 110718, 110721, 110724, 110727,
110730, 110733, 110736, 110739, 110742, 110745, 110748, 110751, 110754, 110757, 110800, 110803, 110806, 110809, 110812,
110815, 110818, 110821, 110824, 110827, 110830, 110833, 110836, 110839, 110842, 110845, 110848, 110851, 110854, 110857,
110900, 110903, 110906, 110909, 110912, 110915, 110918, 110921, 110924, 110927, 110930, 110933, 110936, 110939, 110942,
110945, 110948, 110951, 110954, 110957, 111000, 111003, 111006, 111009, 111012, 111015, 111018, 111021, 111024, 111027,
111030, 111033, 111036, 111039, 111042, 111045, 111048, 111051, 111054, 111057, 111100, 111103, 111106, 111109, 111112,
111115, 111118, 111121, 111124, 111127, 111130, 111133, 111136, 111139, 111142, 111145, 111148, 111151, 111154, 111157,
111200, 111203, 111206, 111209, 111212, 111215, 111218, 111221, 111224, 111227, 111230, 111233, 111236, 111239, 111242,
111245, 111248, 111251, 111254, 111257, 111300, 111303, 111306, 111309, 111312, 111315, 111318, 111321, 111324, 111327,
111330, 111333, 111336, 111339, 111342, 111345, 111348, 111351, 111354, 111357, 111400, 111403, 111406, 111409, 111412,
111415, 111418, 111421, 111424, 111427, 111430, 111433, 111436, 111439, 111442, 111445, 111448, 111451, 111454, 111457,
111500, 111503, 111506, 111509, 111512, 111515, 111518, 111521, 111524, 111527, 111530, 111533, 111536, 111539, 111542,
111545, 111548, 111551, 111554, 111557, 111600, 111603, 111606, 111609, 111612, 111615, 111618, 111621, 111624, 111627,
111630, 111633, 111636, 111639, 111642, 111645, 111648, 111651, 111654, 111657, 111700, 111703, 111706, 111709, 111712,
111715, 111718, 111721, 111724, 111727, 111730, 111733, 111736, 111739, 111742, 111745, 111748, 111751, 111754, 111757,
111800, 111803, 111806, 111809, 111812, 111815, 111818, 111821, 111824, 111827, 111830, 111833, 111836, 111839, 111842,
111845, 111848, 111851, 111854, 111857, 111900, 111903, 111906, 111909, 111912, 111915, 111918, 111921, 111924, 111927,
111930, 111933, 111936, 111939, 111942, 111945, 111948, 111951, 111954, 111957, 112000, 112003, 112006, 112009, 112012,
112015, 112018, 112021, 112024, 112027, 112030, 112033, 112036, 112039, 112042, 112045, 112048, 112051, 112054, 112057,
112100, 112103, 112106, 112109, 112112, 112115, 112118, 112121, 112124, 112127, 112130, 112133, 112136, 112139, 112142,
112145, 112148, 112151, 112154, 112157, 112200, 112203, 112206, 112209, 112212, 112215, 112218, 112221, 112224, 112227,
112230, 112233, 112236, 112239, 112242, 112245, 112248, 112251, 112254, 112257, 112300, 112303, 112306, 112309, 112312,
112315, 112318, 112321, 112324, 112327, 112330, 112333, 112336, 112339, 112342, 112345, 112348, 112351, 112354, 112357,
112400, 112403, 112406, 112409, 112412, 112415, 112418, 112421, 112424, 112427, 112430, 112433, 112436, 112439, 112442,
112445, 112448, 112451, 112454, 112457, 112500, 112503, 112506, 112509, 112512, 112515, 112518, 112521, 112524, 112527,
112530, 112533, 112536, 112539, 112542, 112545, 112548, 112551, 112554, 112557, 112600, 112603, 112606, 112609, 112612,
112615, 112618, 112621, 112624, 112627, 112630, 112633, 112636, 112639, 112642, 112645, 112648, 112651, 112654, 112657,
112700, 112703, 112706, 112709, 112712, 112715, 112718, 112721, 112724, 112727, 112730, 112733, 112736, 112739, 112742,
112745, 112748, 112751, 112754, 112757, 112800, 112803, 112806, 112809, 112812, 112815, 112818, 112821, 112824, 112827,
112830, 112833, 112836, 112839, 112842, 112845, 112848, 112851, 112854, 112857, 112900, 112903, 112906, 112909, 112912,
112915, 112918, 112921, 112924, 112927, 112930, 112933, 112936, 112939, 112942, 112945, 112948, 112951, 112954, 112957,
130000, 130003, 130006, 130009, 130012, 130015, 130018, 130021, 130024, 130027, 130030, 130033, 130036, 130039, 130042,
130045, 130048, 130051, 130054, 130057, 130100, 130103, 130106, 130109, 130112, 130115, 130118, 130121, 130124, 130127,
130130, 130133, 130136, 130139, 130142, 130145, 130148, 130151, 130154, 130157, 130200, 130203, 130206, 130209, 130212,
130215, 130218, 130221, 130224, 130227, 130230, 130233, 130236, 130239, 130242, 130245, 130248, 130251, 130254, 130257,
130300, 130303, 130306, 130309, 130312, 130315, 130318, 130321, 130324, 130327, 130330, 130333, 130336, 130339, 130342,
130345, 130348, 130351, 130354, 130357, 130400, 130403, 130406, 130409, 130412, 130415, 130418, 130421, 130424, 130427,
130430, 130433, 130436, 130439, 130442, 130445, 130448, 130451, 130454, 130457, 130500, 130503, 130506, 130509, 130512,
130515, 130518, 130521, 130524, 130527, 130530, 130533, 130536, 130539, 130542, 130545, 130548, 130551, 130554, 130557,
130600, 130603, 130606, 130609, 130612, 130615, 130618, 130621, 130624, 130627, 130630, 130633, 130636, 130639, 130642,
130645, 130648, 130651, 130654, 130657, 130700, 130703, 130706, 130709, 130712, 130715, 130718, 130721, 130724, 130727,
130730, 130733, 130736, 130739, 130742, 130745, 130748, 130751, 130754, 130757, 130800, 130803, 130806, 130809, 130812,
130815, 130818, 130821, 130824, 130827, 130830, 130833, 130836, 130839, 130842, 130845, 130848, 130851, 130854, 130857,
130900, 130903, 130906, 130909, 130912, 130915, 130918, 130921, 130924, 130927, 130930, 130933, 130936, 130939, 130942,
130945, 130948, 130951, 130954, 130957, 131000, 131003, 131006, 131009, 131012, 131015, 131018, 131021, 131024, 131027,
131030, 131033, 131036, 131039, 131042, 131045, 131048, 131051, 131054, 131057, 131100, 131103, 131106, 131109, 131112,
131115, 131118, 131121, 131124, 131127, 131130, 131133, 131136, 131139, 131142, 131145, 131148, 131151, 131154, 131157,
131200, 131203, 131206, 131209, 131212, 131215, 131218, 131221, 131224, 131227, 131230, 131233, 131236, 131239, 131242,
131245, 131248, 131251, 131254, 131257, 131300, 131303, 131306, 131309, 131312, 131315, 131318, 131321, 131324, 131327,
131330, 131333, 131336, 131339, 131342, 131345, 131348, 131351, 131354, 131357, 131400, 131403, 131406, 131409, 131412,
131415, 131418, 131421, 131424, 131427, 131430, 131433, 131436, 131439, 131442, 131445, 131448, 131451, 131454, 131457,
131500, 131503, 131506, 131509, 131512, 131515, 131518, 131521, 131524, 131527, 131530, 131533, 131536, 131539, 131542,
131545, 131548, 131551, 131554, 131557, 131600, 131603, 131606, 131609, 131612, 131615, 131618, 131621, 131624, 131627,
131630, 131633, 131636, 131639, 131642, 131645, 131648, 131651, 131654, 131657, 131700, 131703, 131706, 131709, 131712,
131715, 131718, 131721, 131724, 131727, 131730, 131733, 131736, 131739, 131742, 131745, 131748, 131751, 131754, 131757,
131800, 131803, 131806, 131809, 131812, 131815, 131818, 131821, 131824, 131827, 131830, 131833, 131836, 131839, 131842,
131845, 131848, 131851, 131854, 131857, 131900, 131903, 131906, 131909, 131912, 131915, 131918, 131921, 131924, 131927,
131930, 131933, 131936, 131939, 131942, 131945, 131948, 131951, 131954, 131957, 132000, 132003, 132006, 132009, 132012,
132015, 132018, 132021, 132024, 132027, 132030, 132033, 132036, 132039, 132042, 132045, 132048, 132051, 132054, 132057,
132100, 132103, 132106, 132109, 132112, 132115, 132118, 132121, 132124, 132127, 132130, 132133, 132136, 132139, 132142,
132145, 132148, 132151, 132154, 132157, 132200, 132203, 132206, 132209, 132212, 132215, 132218, 132221, 132224, 132227,
132230, 132233, 132236, 132239, 132242, 132245, 132248, 132251, 132254, 132257, 132300, 132303, 132306, 132309, 132312,
132315, 132318, 132321, 132324, 132327, 132330, 132333, 132336, 132339, 132342, 132345, 132348, 132351, 132354, 132357,
132400, 132403, 132406, 132409, 132412, 132415, 132418, 132421, 132424, 132427, 132430, 132433, 132436, 132439, 132442,
132445, 132448, 132451, 132454, 132457, 132500, 132503, 132506, 132509, 132512, 132515, 132518, 132521, 132524, 132527,
132530, 132533, 132536, 132539, 132542, 132545, 132548, 132551, 132554, 132557, 132600, 132603, 132606, 132609, 132612,
132615, 132618, 132621, 132624, 132627, 132630, 132633, 132636, 132639, 132642, 132645, 132648, 132651, 132654, 132657,
132700, 132703, 132706, 132709, 132712, 132715, 132718, 132721, 132724, 132727, 132730, 132733, 132736, 132739, 132742,
132745, 132748, 132751, 132754, 132757, 132800, 132803, 132806, 132809, 132812, 132815, 132818, 132821, 132824, 132827,
132830, 132833, 132836, 132839, 132842, 132845, 132848, 132851, 132854, 132857, 132900, 132903, 132906, 132909, 132912,
132915, 132918, 132921, 132924, 132927, 132930, 132933, 132936, 132939, 132942, 132945, 132948, 132951, 132954, 132957,
133000, 133003, 133006, 133009, 133012, 133015, 133018, 133021, 133024, 133027, 133030, 133033, 133036, 133039, 133042,
133045, 133048, 133051, 133054, 133057, 133100, 133103, 133106, 133109, 133112, 133115, 133118, 133121, 133124, 133127,
133130, 133133, 133136, 133139, 133142, 133145, 133148, 133151, 133154, 133157, 133200, 133203, 133206, 133209, 133212,
133215, 133218, 133221, 133224, 133227, 133230, 133233, 133236, 133239, 133242, 133245, 133248, 133251, 133254, 133257,
133300, 133303, 133306, 133309, 133312, 133315, 133318, 133321, 133324, 133327, 133330, 133333, 133336, 133339, 133342,
133345, 133348, 133351, 133354, 133357, 133400, 133403, 133406, 133409, 133412, 133415, 133418, 133421, 133424, 133427,
133430, 133433, 133436, 133439, 133442, 133445, 133448, 133451, 133454, 133457, 133500, 133503, 133506, 133509, 133512,
133515, 133518, 133521, 133524, 133527, 133530, 133533, 133536, 133539, 133542, 133545, 133548, 133551, 133554, 133557,
133600, 133603, 133606, 133609, 133612, 133615, 133618, 133621, 133624, 133627, 133630, 133633, 133636, 133639, 133642,
133645, 133648, 133651, 133654, 133657, 133700, 133703, 133706, 133709, 133712, 133715, 133718, 133721, 133724, 133727,
133730, 133733, 133736, 133739, 133742, 133745, 133748, 133751, 133754, 133757, 133800, 133803, 133806, 133809, 133812,
133815, 133818, 133821, 133824, 133827, 133830, 133833, 133836, 133839, 133842, 133845, 133848, 133851, 133854, 133857,
133900, 133903, 133906, 133909, 133912, 133915, 133918, 133921, 133924, 133927, 133930, 133933, 133936, 133939, 133942,
133945, 133948, 133951, 133954, 133957, 134000, 134003, 134006, 134009, 134012, 134015, 134018, 134021, 134024, 134027,
134030, 134033, 134036, 134039, 134042, 134045, 134048, 134051, 134054, 134057, 134100, 134103, 134106, 134109, 134112,
134115, 134118, 134121, 134124, 134127, 134130, 134133, 134136, 134139, 134142, 134145, 134148, 134151, 134154, 134157,
134200, 134203, 134206, 134209, 134212, 134215, 134218, 134221, 134224, 134227, 134230, 134233, 134236, 134239, 134242,
134245, 134248, 134251, 134254, 134257, 134300, 134303, 134306, 134309, 134312, 134315, 134318, 134321, 134324, 134327,
134330, 134333, 134336, 134339, 134342, 134345, 134348, 134351, 134354, 134357, 134400, 134403, 134406, 134409, 134412,
134415, 134418, 134421, 134424, 134427, 134430, 134433, 134436, 134439, 134442, 134445, 134448, 134451, 134454, 134457,
134500, 134503, 134506, 134509, 134512, 134515, 134518, 134521, 134524, 134527, 134530, 134533, 134536, 134539, 134542,
134545, 134548, 134551, 134554, 134557, 134600, 134603, 134606, 134609, 134612, 134615, 134618, 134621, 134624, 134627,
134630, 134633, 134636, 134639, 134642, 134645, 134648, 134651, 134654, 134657, 134700, 134703, 134706, 134709, 134712,
134715, 134718, 134721, 134724, 134727, 134730, 134733, 134736, 134739, 134742, 134745, 134748, 134751, 134754, 134757,
134800, 134803, 134806, 134809, 134812, 134815, 134818, 134821, 134824, 134827, 134830, 134833, 134836, 134839, 134842,
134845, 134848, 134851, 134854, 134857, 134900, 134903, 134906, 134909, 134912, 134915, 134918, 134921, 134924, 134927,
134930, 134933, 134936, 134939, 134942, 134945, 134948, 134951, 134954, 134957, 135000, 135003, 135006, 135009, 135012,
135015, 135018, 135021, 135024, 135027, 135030, 135033, 135036, 135039, 135042, 135045, 135048, 135051, 135054, 135057,
135100, 135103, 135106, 135109, 135112, 135115, 135118, 135121, 135124, 135127, 135130, 135133, 135136, 135139, 135142,
135145, 135148, 135151, 135154, 135157, 135200, 135203, 135206, 135209, 135212, 135215, 135218, 135221, 135224, 135227,
135230, 135233, 135236, 135239, 135242, 135245, 135248, 135251, 135254, 135257, 135300, 135303, 135306, 135309, 135312,
135315, 135318, 135321, 135324, 135327, 135330, 135333, 135336, 135339, 135342, 135345, 135348, 135351, 135354, 135357,
135400, 135403, 135406, 135409, 135412, 135415, 135418, 135421, 135424, 135427, 135430, 135433, 135436, 135439, 135442,
135445, 135448, 135451, 135454, 135457, 135500, 135503, 135506, 135509, 135512, 135515, 135518, 135521, 135524, 135527,
135530, 135533, 135536, 135539, 135542, 135545, 135548, 135551, 135554, 135557, 135600, 135603, 135606, 135609, 135612,
135615, 135618, 135621, 135624, 135627, 135630, 135633, 135636, 135639, 135642, 135645, 135648, 135651, 135654, 135657,
135700, 135703, 135706, 135709, 135712, 135715, 135718, 135721, 135724, 135727, 135730, 135733, 135736, 135739, 135742,
135745, 135748, 135751, 135754, 135757, 135800, 135803, 135806, 135809, 135812, 135815, 135818, 135821, 135824, 135827,
135830, 135833, 135836, 135839, 135842, 135845, 135848, 135851, 135854, 135857, 135900, 135903, 135906, 135909, 135912,
135915, 135918, 135921, 135924, 135927, 135930, 135933, 135936, 135939, 135942, 135945, 135948, 135951, 135954, 135957,
140000, 140003, 140006, 140009, 140012, 140015, 140018, 140021, 140024, 140027, 140030, 140033, 140036, 140039, 140042,
140045, 140048, 140051, 140054, 140057, 140100, 140103, 140106, 140109, 140112, 140115, 140118, 140121, 140124, 140127,
140130, 140133, 140136, 140139, 140142, 140145, 140148, 140151, 140154, 140157, 140200, 140203, 140206, 140209, 140212,
140215, 140218, 140221, 140224, 140227, 140230, 140233, 140236, 140239, 140242, 140245, 140248, 140251, 140254, 140257,
140300, 140303, 140306, 140309, 140312, 140315, 140318, 140321, 140324, 140327, 140330, 140333, 140336, 140339, 140342,
140345, 140348, 140351, 140354, 140357, 140400, 140403, 140406, 140409, 140412, 140415, 140418, 140421, 140424, 140427,
140430, 140433, 140436, 140439, 140442, 140445, 140448, 140451, 140454, 140457, 140500, 140503, 140506, 140509, 140512,
140515, 140518, 140521, 140524, 140527, 140530, 140533, 140536, 140539, 140542, 140545, 140548, 140551, 140554, 140557,
140600, 140603, 140606, 140609, 140612, 140615, 140618, 140621, 140624, 140627, 140630, 140633, 140636, 140639, 140642,
140645, 140648, 140651, 140654, 140657, 140700, 140703, 140706, 140709, 140712, 140715, 140718, 140721, 140724, 140727,
140730, 140733, 140736, 140739, 140742, 140745, 140748, 140751, 140754, 140757, 140800, 140803, 140806, 140809, 140812,
140815, 140818, 140821, 140824, 140827, 140830, 140833, 140836, 140839, 140842, 140845, 140848, 140851, 140854, 140857,
140900, 140903, 140906, 140909, 140912, 140915, 140918, 140921, 140924, 140927, 140930, 140933, 140936, 140939, 140942,
140945, 140948, 140951, 140954, 140957, 141000, 141003, 141006, 141009, 141012, 141015, 141018, 141021, 141024, 141027,
141030, 141033, 141036, 141039, 141042, 141045, 141048, 141051, 141054, 141057, 141100, 141103, 141106, 141109, 141112,
141115, 141118, 141121, 141124, 141127, 141130, 141133, 141136, 141139, 141142, 141145, 141148, 141151, 141154, 141157,
141200, 141203, 141206, 141209, 141212, 141215, 141218, 141221, 141224, 141227, 141230, 141233, 141236, 141239, 141242,
141245, 141248, 141251, 141254, 141257, 141300, 141303, 141306, 141309, 141312, 141315, 141318, 141321, 141324, 141327,
141330, 141333, 141336, 141339, 141342, 141345, 141348, 141351, 141354, 141357, 141400, 141403, 141406, 141409, 141412,
141415, 141418, 141421, 141424, 141427, 141430, 141433, 141436, 141439, 141442, 141445, 141448, 141451, 141454, 141457,
141500, 141503, 141506, 141509, 141512, 141515, 141518, 141521, 141524, 141527, 141530, 141533, 141536, 141539, 141542,
141545, 141548, 141551, 141554, 141557, 141600, 141603, 141606, 141609, 141612, 141615, 141618, 141621, 141624, 141627,
141630, 141633, 141636, 141639, 141642, 141645, 141648, 141651, 141654, 141657, 141700, 141703, 141706, 141709, 141712,
141715, 141718, 141721, 141724, 141727, 141730, 141733, 141736, 141739, 141742, 141745, 141748, 141751, 141754, 141757,
141800, 141803, 141806, 141809, 141812, 141815, 141818, 141821, 141824, 141827, 141830, 141833, 141836, 141839, 141842,
141845, 141848, 141851, 141854, 141857, 141900, 141903, 141906, 141909, 141912, 141915, 141918, 141921, 141924, 141927,
141930, 141933, 141936, 141939, 141942, 141945, 141948, 141951, 141954, 141957, 142000, 142003, 142006, 142009, 142012,
142015, 142018, 142021, 142024, 142027, 142030, 142033, 142036, 142039, 142042, 142045, 142048, 142051, 142054, 142057,
142100, 142103, 142106, 142109, 142112, 142115, 142118, 142121, 142124, 142127, 142130, 142133, 142136, 142139, 142142,
142145, 142148, 142151, 142154, 142157, 142200, 142203, 142206, 142209, 142212, 142215, 142218, 142221, 142224, 142227,
142230, 142233, 142236, 142239, 142242, 142245, 142248, 142251, 142254, 142257, 142300, 142303, 142306, 142309, 142312,
142315, 142318, 142321, 142324, 142327, 142330, 142333, 142336, 142339, 142342, 142345, 142348, 142351, 142354, 142357,
142400, 142403, 142406, 142409, 142412, 142415, 142418, 142421, 142424, 142427, 142430, 142433, 142436, 142439, 142442,
142445, 142448, 142451, 142454, 142457, 142500, 142503, 142506, 142509, 142512, 142515, 142518, 142521, 142524, 142527,
142530, 142533, 142536, 142539, 142542, 142545, 142548, 142551, 142554, 142557, 142600, 142603, 142606, 142609, 142612,
142615, 142618, 142621, 142624, 142627, 142630, 142633, 142636, 142639, 142642, 142645, 142648, 142651, 142654, 142657,
142700, 142703, 142706, 142709, 142712, 142715, 142718, 142721, 142724, 142727, 142730, 142733, 142736, 142739, 142742,
142745, 142748, 142751, 142754, 142757, 142800, 142803, 142806, 142809, 142812, 142815, 142818, 142821, 142824, 142827,
142830, 142833, 142836, 142839, 142842, 142845, 142848, 142851, 142854, 142857, 142900, 142903, 142906, 142909, 142912,
142915, 142918, 142921, 142924, 142927, 142930, 142933, 142936, 142939, 142942, 142945, 142948, 142951, 142954, 142957,
143000, 143003, 143006, 143009, 143012, 143015, 143018, 143021, 143024, 143027, 143030, 143033, 143036, 143039, 143042,
143045, 143048, 143051, 143054, 143057, 143100, 143103, 143106, 143109, 143112, 143115, 143118, 143121, 143124, 143127,
143130, 143133, 143136, 143139, 143142, 143145, 143148, 143151, 143154, 143157, 143200, 143203, 143206, 143209, 143212,
143215, 143218, 143221, 143224, 143227, 143230, 143233, 143236, 143239, 143242, 143245, 143248, 143251, 143254, 143257,
143300, 143303, 143306, 143309, 143312, 143315, 143318, 143321, 143324, 143327, 143330, 143333, 143336, 143339, 143342,
143345, 143348, 143351, 143354, 143357, 143400, 143403, 143406, 143409, 143412, 143415, 143418, 143421, 143424, 143427,
143430, 143433, 143436, 143439, 143442, 143445, 143448, 143451, 143454, 143457, 143500, 143503, 143506, 143509, 143512,
143515, 143518, 143521, 143524, 143527, 143530, 143533, 143536, 143539, 143542, 143545, 143548, 143551, 143554, 143557,
143600, 143603, 143606, 143609, 143612, 143615, 143618, 143621, 143624, 143627, 143630, 143633, 143636, 143639, 143642,
143645, 143648, 143651, 143654, 143657, 143700, 143703, 143706, 143709, 143712, 143715, 143718, 143721, 143724, 143727,
143730, 143733, 143736, 143739, 143742, 143745, 143748, 143751, 143754, 143757, 143800, 143803, 143806, 143809, 143812,
143815, 143818, 143821, 143824, 143827, 143830, 143833, 143836, 143839, 143842, 143845, 143848, 143851, 143854, 143857,
143900, 143903, 143906, 143909, 143912, 143915, 143918, 143921, 143924, 143927, 143930, 143933, 143936, 143939, 143942,
143945, 143948, 143951, 143954, 143957, 144000, 144003, 144006, 144009, 144012, 144015, 144018, 144021, 144024, 144027,
144030, 144033, 144036, 144039, 144042, 144045, 144048, 144051, 144054, 144057, 144100, 144103, 144106, 144109, 144112,
144115, 144118, 144121, 144124, 144127, 144130, 144133, 144136, 144139, 144142, 144145, 144148, 144151, 144154, 144157,
144200, 144203, 144206, 144209, 144212, 144215, 144218, 144221, 144224, 144227, 144230, 144233, 144236, 144239, 144242,
144245, 144248, 144251, 144254, 144257, 144300, 144303, 144306, 144309, 144312, 144315, 144318, 144321, 144324, 144327,
144330, 144333, 144336, 144339, 144342, 144345, 144348, 144351, 144354, 144357, 144400, 144403, 144406, 144409, 144412,
144415, 144418, 144421, 144424, 144427, 144430, 144433, 144436, 144439, 144442, 144445, 144448, 144451, 144454, 144457,
144500, 144503, 144506, 144509, 144512, 144515, 144518, 144521, 144524, 144527, 144530, 144533, 144536, 144539, 144542,
144545, 144548, 144551, 144554, 144557, 144600, 144603, 144606, 144609, 144612, 144615, 144618, 144621, 144624, 144627,
144630, 144633, 144636, 144639, 144642, 144645, 144648, 144651, 144654, 144657, 144700, 144703, 144706, 144709, 144712,
144715, 144718, 144721, 144724, 144727, 144730, 144733, 144736, 144739, 144742, 144745, 144748, 144751, 144754, 144757,
144800, 144803, 144806, 144809, 144812, 144815, 144818, 144821, 144824, 144827, 144830, 144833, 144836, 144839, 144842,
144845, 144848, 144851, 144854, 144857, 144900, 144903, 144906, 144909, 144912, 144915, 144918, 144921, 144924, 144927,
144930, 144933, 144936, 144939, 144942, 144945, 144948, 144951, 144954, 144957, 145000, 145003, 145006, 145009, 145012,
145015, 145018, 145021, 145024, 145027, 145030, 145033, 145036, 145039, 145042, 145045, 145048, 145051, 145054, 145057,
145100, 145103, 145106, 145109, 145112, 145115, 145118, 145121, 145124, 145127, 145130, 145133, 145136, 145139, 145142,
145145, 145148, 145151, 145154, 145157, 145200, 145203, 145206, 145209, 145212, 145215, 145218, 145221, 145224, 145227,
145230, 145233, 145236, 145239, 145242, 145245, 145248, 145251, 145254, 145257, 145300, 145303, 145306, 145309, 145312,
145315, 145318, 145321, 145324, 145327, 145330, 145333, 145336, 145339, 145342, 145345, 145348, 145351, 145354, 145357,
145400, 145403, 145406, 145409, 145412, 145415, 145418, 145421, 145424, 145427, 145430, 145433, 145436, 145439, 145442,
145445, 145448, 145451, 145454, 145457, 145500, 145503, 145506, 145509, 145512, 145515, 145518, 145521, 145524, 145527,
145530, 145533, 145536, 145539, 145542, 145545, 145548, 145551, 145554, 145557, 145600, 145603, 145606, 145609, 145612,
145615, 145618, 145621, 145624, 145627, 145630, 145633, 145636, 145639, 145642, 145645, 145648, 145651, 145654, 145657,
145700, 145703, 145706, 145709, 145712, 145715, 145718, 145721, 145724, 145727, 145730, 145733, 145736, 145739, 145742,
145745, 145748, 145751, 145754, 145757, 145800, 145803, 145806, 145809, 145812, 145815, 145818, 145821, 145824, 145827,
145830, 145833, 145836, 145839, 145842, 145845, 145848, 145851, 145854, 145857, 145900, 145903, 145906, 145909, 145912,
145915, 145918, 145921, 145924, 145927, 145930, 145933, 145936, 145939, 145942, 145945, 145948, 145951, 145954, 145957,
150000]
trade_minutes = [
925, 930, 931, 932, 933, 934, 935, 936, 937, 938, 939, 940, 941, 942, 943,
944, 945, 946, 947, 948, 949, 950, 951, 952, 953, 954, 955, 956, 957, 958, 959,
1000, 1001, 1002, 1003, 1004, 1005, 1006, 1007, 1008, 1009, 1010, 1011, 1012, 1013, 1014,
1015, 1016, 1017, 1018, 1019, 1020, 1021, 1022, 1023, 1024, 1025, 1026, 1027, 1028, 1029,
1030, 1031, 1032, 1033, 1034, 1035, 1036, 1037, 1038, 1039, 1040, 1041, 1042, 1043, 1044,
1045, 1046, 1047, 1048, 1049, 1050, 1051, 1052, 1053, 1054, 1055, 1056, 1057, 1058, 1059,
1100, 1101, 1102, 1103, 1104, 1105, 1106, 1107, 1108, 1109, 1110, 1111, 1112, 1113, 1114,
1115, 1116, 1117, 1118, 1119, 1120, 1121, 1122, 1123, 1124, 1125, 1126, 1127, 1128, 1129,
1300, 1301, 1302, 1303, 1304, 1305, 1306, 1307, 1308, 1309, 1310, 1311, 1312, 1313, 1314,
1315, 1316, 1317, 1318, 1319, 1320, 1321, 1322, 1323, 1324, 1325, 1326, 1327, 1328, 1329,
1330, 1331, 1332, 1333, 1334, 1335, 1336, 1337, 1338, 1339, 1340, 1341, 1342, 1343, 1344,
1345, 1346, 1347, 1348, 1349, 1350, 1351, 1352, 1353, 1354, 1355, 1356, 1357, 1358, 1359,
1400, 1401, 1402, 1403, 1404, 1405, 1406, 1407, 1408, 1409, 1410, 1411, 1412, 1413, 1414,
1415, 1416, 1417, 1418, 1419, 1420, 1421, 1422, 1423, 1424, 1425, 1426, 1427, 1428, 1429,
1430, 1431, 1432, 1433, 1434, 1435, 1436, 1437, 1438, 1439, 1440, 1441, 1442, 1443, 1444,
1445, 1446, 1447, 1448, 1449, 1450, 1451, 1452, 1453, 1454, 1455, 1456, 1457, 1458, 1459,
1500]

stock_address = base_address+'daily/'

trade_calendar = pd.read_pickle(stock_address + 'trade_calendar.pkl')
trade_dates = pd.read_pickle(stock_address + 'trade_date.pkl')
trade_weeks = trade_calendar[trade_calendar['WeekEnd']==1].index.to_list()
trade_months = trade_calendar[trade_calendar['MonthEnd']==1].index.to_list()
trade_quarters = trade_calendar[trade_calendar['QuarterEnd']==1].index.to_list()
trade_half_years = trade_calendar[trade_calendar['HalfYearEnd']==1].index.to_list()
trade_years = trade_calendar[trade_calendar['YearEnd']==1].index.to_list()

report_dates = [
20060331, 20060630, 20060930, 20061231, 20070331, 20070630, 20070930, 20071231,
20080331, 20080630, 20080930, 20081231, 20090331, 20090630, 20090930, 20091231,
20100331, 20100630, 20100930, 20101231, 20110331, 20110630, 20110930, 20111231,
20120331, 20120630, 20120930, 20121231, 20130331, 20130630, 20130930, 20131231,
20140331, 20140630, 20140930, 20141231, 20150331, 20150630, 20150930, 20151231,
20160331, 20160630, 20160930, 20161231, 20170331, 20170630, 20170930, 20171231,
20180331, 20180630, 20180930, 20181231, 20190331, 20190630, 20190930, 20191231,
20200331, 20200630, 20200930, 20201231, 20210331, 20210630, 20210930, 20211231,
20220331, 20220630, 20220930, 20221231, 20230331, 20230630, 20230930, 20231231] # 财报报告日

def get_today(dividing_point=15):
    # 下午3点后才算今天，否则归为昨日
    today = dt.datetime.now()
    if today.hour + today.minute / 60 < dividing_point:
        today -= dt.timedelta(1)
    today = int(today.strftime('%Y%m%d'))
    return today

def _check_input_date(date):

    if type(date) == int:
        _date = [str(date)]
    elif type(date) == list:
        _date = [str(x) for x in date]
    else:
        raise Exception("dateTime传入类型错误：目前只支持int和List(int)类型！")
    return _date


# 调用函数1.1：获取当前的交易日
def get_recent_trade_date(base_date=None, period='D', dividing_point=15):
    if base_date is None:
        base_date = get_today(dividing_point)
    else:
        base_date = int(base_date)

    period_dict = {'D': trade_dates, 'W': trade_weeks, 'M': trade_months,
                   'Q': trade_quarters, 'H': trade_half_years, 'Y': trade_years}

    if isinstance(period, list):
        recent_trade_date = max([x for x in period if x <= base_date])
    elif period in period_dict.keys():
        recent_trade_date = max([x for x in period_dict[period] if x <= base_date])
    else:
        raise ValueError

    return recent_trade_date
# 调用函数1.2：获取前一个交易日
def get_pre_trade_date(base_date=None, offset=1, period='D', dividing_point=15):
    if base_date is None:
        base_date = get_today(dividing_point)
    else:
        base_date = int(base_date)
    recent_trade_date = get_recent_trade_date(base_date, period, dividing_point)
    period_dict = {'D': trade_dates, 'W': trade_weeks, 'M': trade_months,
                   'Q': trade_quarters, 'H': trade_half_years, 'Y': trade_years}

    if isinstance(period, list):
        preTradeDate = period[period.index(recent_trade_date) - offset]

    elif period in period_dict.keys():
        preTradeDate = period_dict[period][max(period_dict[period].index(recent_trade_date) - offset,0)]

    else:
        raise ValueError

    return preTradeDate
# 调用函数1.3：获取某个区间的交易日
def get_date_range(start_date, end_date=None, period='D', dividing_point=15):
    start_date = int(start_date)
    if end_date is None:
        end_date = get_today(dividing_point)
    else:
        end_date = int(end_date)

    period_dict = {'D': trade_dates, 'W': trade_weeks, 'M': trade_months, 'Q': trade_quarters,
                   'H': trade_half_years, 'Y': trade_years, 'R': report_dates}

    if period in period_dict.keys():
        date_range = [x for x in period_dict[period] if start_date <= x <= end_date]
    else:
        raise ValueError
    return date_range
# 调用函数1.4：获取两个日期之间的交易日
def get_trade_date_interval(date=None, base_date=base_date):

    _date = get_recent_trade_date(date)
    _base_date = get_recent_trade_date(base_date)
    interval = trade_dates.index(_date) - trade_dates.index(_base_date) - 1
    return interval


# 调用函数2.1：时间和int的转换
def trans_int2datetime(date, out_format='date', input_date=True, time_digit=0):

    _date0 = str(int(date)).strip().replace(' ', '')
    if input_date:
        _date = _date0[:8]
        _time = _date0[8:].zfill(time_digit)
        if out_format in ('date', 'dates', 'd', 'D'):
            return dt.datetime(int(_date[:4]), int(_date[4:6]), int(_date[6:8]))
        elif out_format in ('hour', 'hours', 'h', 'H'):
            return dt.datetime(int(_date[:4]), int(_date[4:6]), int(_date[6:8]), int(_time[:2]))
        elif out_format in ('minute', 'min', 'm', 'M'):
            return dt.datetime(int(_date[:4]), int(_date[4:6]), int(_date[6:8]), int(_time[:2]), int(_time[2:4]))
        elif out_format in ('second', 'seconds', 's', 'S'):
            return dt.datetime(int(_date[:4]), int(_date[4:6]), int(_date[6:8]),
                               int(_time[:2]), int(_time[2:4]), int(_time[4:6]))
        elif out_format in ('ms'):
            return dt.datetime(int(_date[:4]), int(_date[4:6]), int(_date[6:8]),
                               int(_time[:2]), int(_time[2:4]), int(_time[4:6]), int(_time[6:9]))
        else:
            raise(ValueError)
    else:
        _time = _date0.zfill(time_digit)
        if out_format in ('hour', 'hours', 'h', 'H'):
            return dt.timedelta(hours=int(_time[:2]))
        elif out_format in ('minute', 'min', 'm', 'M'):
            return dt.timedelta(hours=int(_time[:2]), minutes=int(_time[2:4]))
        elif out_format in ('second', 'seconds', 's', 'S'):
            return dt.timedelta(hours=int(_time[:2]), minutes=int(_time[2:4]), seconds=int(_time[4:6]))
        elif out_format in ('ms'):
            return dt.timedelta(hours=int(_time[:2]), minutes=int(_time[2:4]),
                                seconds=int(_time[4:6]), microseconds=int(_time[6:9]))
        else:
            raise(ValueError)

def trans_datetime2int(date):

    if isinstance(date, dt.datetime):
        return int(dt.datetime.strftime(date, '%Y%m%d'))
    elif isinstance(date, str):
        _date = date.strip()
        if not _date.isdigit():
            _date = date.replace('-', ' ').replace('_', ' ').replace('.', ' ').split()
            _date = _date[0] + _date[1].zfill(2) + _date[2].zfill(2)
        return int(_date)
    elif isinstance(date, float):
        return int(date)
    elif isinstance(date, int) or isinstance(date, np.int):
        return date
    else:
        raise(ValueError)


